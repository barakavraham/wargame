{% extends 'layout.html' %}

{% block styles %}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/battle_results.css') }}">
{% endblock styles %}
{% block title %} <title> Battle results </title> {% endblock title %}
{% if current_user.army == battle_result.attacker_army %}
    {% set main_army = battle_result.attacker_army %}
    {% set main_result = battle_result.attacker_result %}
    {% set secondary_army = battle_result.attacked_army %}
    {% set secondary_result = battle_result.attacked_result %}
    {% set did_win = battle_result.did_attacker_win == True %}
{% else %}
    {% set main_army = battle_result.attacked_army %}
    {% set main_result = battle_result.attacked_result %}
    {% set secondary_army = battle_result.attacker_army %}
    {% set secondary_result = battle_result.attacker_result %}
    {% set did_win = battle_result.did_attacker_win == False %}
{% endif %}

{% block content %}
    {% if battle_result.did_attacker_win == None %}
        <h4 class="text-center text-warning">Its a tie!</h4>
    {% elif did_win == True %}
        <h4 class="text-center text-success">You won the battle!</h4>
    {% else %}
        <h4 class="text-center text-danger">You lost the battle!</h4>
    {% endif %}
    <div class="row battle-results d-flex justify-content-between">
        <div class="left-army-result col-sm d-flex align-items-center justify-content-center">
            {% if main_army.user.is_google_user == True %}
                <img class="avatar img-fluid " src="{{ main_army.user.avatar }}" alt="{{ main_army.name }}"/>
            {% else %}
                <img class="avatar img-fluid " src="{{ url_for('static', filename='images/'+main_army.user.avatar) }}" alt="{{ main_army.name }}"/>
            {% endif %}
            <div class="results justify-content-between">
                <div class="d-flex justify-content-evenly align-items-center">
                    <img class="mx-2" src="{{ url_for('static', filename='images/swords.png') }}" alt="swords" />
                    <h3 class="mr-5 army-name">{{ main_army.name }}</h3>
                </div>
                <div>
                    <h5 class="text-center mt-1 text-danger">Weapons lost:</h5>
                    {% for result in main_result %}
                        <p class="text-center"><img src="{{ url_for('static', filename='images/'+shop_items[result].picture_name) }}"
                            alt="{{ shop_items[result].display_name }}" /> {{ main_result[result] }}</p>
                    {% endfor %}
                </div>
            </div>
        </div>
        <div class="right-army-result col-sm d-flex align-items-center justify-content-center">
            <div class="results justify-content-between">
                <div class="d-flex justify-content-evenly align-items-center secondary-army">
                    <h3 class="ml-5 army-name">{{ secondary_army.name }}</h3>
                    <img class="mx-2" src="{{ url_for('static', filename='images/swords.png') }}" alt="swords" />
                </div>
                <div>
                    <h5 class="text-center mt-1 text-danger">Enemy weapons lost:</h5>
                    {% for result in secondary_result %}
                    <p class="text-center">{{ secondary_result[result] }} <img src="{{ url_for('static', filename='images/'+shop_items[result].picture_name) }}"
                        alt="{{ shop_items[result].display_name }}" /></p>
                        {% endfor %}
                </div>
            </div>
            {% if secondary_army.user.is_google_user == True %}
                <img class="avatar img-fluid " src="{{ secondary_army.user.avatar }}" alt="{{ main_army.name }}"/>
            {% else %}
                <img class="avatar img-fluid " src="{{ url_for('static', filename='images/'+secondary_army.user.avatar) }}" alt="{{ main_army.name }}"/>
            {% endif %}
        </div>
    </div>
{% endblock content %}
        